<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="META_TITLE"></title>
  <!-- Favicon -->
  <link rel="icon" href="./assets/favicon.png" type="image/png">
  <link rel="apple-touch-icon" href="./assets/favicon.png">
  <!-- Description for link preview -->
  <meta name="description" content="" data-i18n="META_DESC" data-i18n-attr="content">
  <meta property="og:description" content="" data-i18n="META_OG_DESC" data-i18n-attr="content">
  <link rel="stylesheet" href="./style.css?v=0320" />
  <!-- SunCalc: 太阳/月亮高度（仅后台计算，不在前台露出） -->
  <script src="https://unpkg.com/suncalc@1.9.0/suncalc.js"></script>
  <!-- Chart.js: 1小时 C值柱状图 -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="wrap">
    <header class="head">
      <div class="brandRow">
        <div class="brand">
        <div class="logo logoPlain">
          <img class="logoImg" src="./assets/logo-v2.png" alt="" data-i18n="HDR_LOGO_ALT" data-i18n-attr="alt">
        </div>
          <div class="titleBlock">
            <div class="titleRow">
              <h1 class="brandTitle"><span class="brandEn" data-i18n="HDR_TITLE_BRAND"></span> <span class="brandCn" data-i18n="HDR_TITLE_BRAND"></span></h1>
            </div>
          </div>
        </div>
      </div>

      <div class="headRight">
        <button id="btnAbout" type="button" class="topLink" aria-label="" data-i18n="HDR_BTN_ABOUT" data-i18n-attr="aria-label" data-i18n-attr-key="HDR_BTN_ABOUT_ARIA"></button>
        <div class="langToggle" id="langToggle" aria-label="" data-i18n="HDR_LANG_TOGGLE_ARIA" data-i18n-attr="aria-label" data-i18n-attr-key="HDR_LANG_TOGGLE_ARIA">
          <button type="button" class="langOpt" data-lang="cn" data-i18n="HDR_LANG_CN_LABEL"></button>
          <span class="langSep">|</span>
          <button type="button" class="langOpt" data-lang="en" data-i18n="HDR_LANG_EN_LABEL"></button>
        </div>
      </div>
    </header>

    <section class="card topCard">
      <div class="grid2">
        <label class="field fieldInline">
          <span class="label" data-i18n="FORM_LABEL_LAT"></span>
          <input id="lat" type="number" step="0.0001" placeholder="" data-i18n="FORM_PLACEHOLDER_LAT" data-i18n-attr="placeholder" />
        </label>
        <label class="field fieldInline">
          <span class="label" data-i18n="FORM_LABEL_LON"></span>
          <input id="lon" type="number" step="0.0001" placeholder="" data-i18n="FORM_PLACEHOLDER_LON" data-i18n-attr="placeholder" />
        </label>
      </div>

      <div class="row actions">
        <button id="btnGeo" type="button" class="btn secondary" data-i18n="FORM_BTN_GEO"></button>
        <button id="btnRun" type="button" class="btn primary" data-i18n="FORM_BTN_RUN"></button>
      </div>

      <details class="faq">
        <summary id="geoHintSummary" data-i18n="FORM_GEO_HINT_SUMMARY"></summary>
        <div class="faqBody" id="geoHintBody" data-i18n="FORM_GEO_HINT_BODY_MAIN"></div>
      </details>

      <div class="row statusRow" aria-label="" data-i18n="STATUS_ROW_ARIA" data-i18n-attr="aria-label" data-i18n-attr-key="STATUS_ROW_ARIA">
        <div class="statusPills" id="statusDots"></div>
        <div class="statusText" id="statusText" aria-live="polite" data-i18n="STATUS_TEXT_WAITING"></div>
      </div>
    </section>

    <section class="tabs">
      <div class="tabsLeft">
        <button class="tab active" data-tab="t1" data-i18n="TAB_T1_LABEL"></button>
        <button class="tab" data-tab="t3" data-i18n="TAB_T3_LABEL"></button>
        <button class="tab" data-tab="t72" data-i18n="TAB_T72_LABEL"></button>
      </div>
    </section>

    <!-- 1小时 -->
    <section id="t1" class="pane active">
      <div class="oneHourStack">
      <!-- 上：结论条 -->
      <div class="card hero">
        <div class="k" data-i18n="T1_HERO_TITLE"></div>

        <!-- 保留原来的数据锚点，JS 才能填进去 -->
        <div class="big" id="oneHeroLabel" data-i18n="UI_PLACEHOLDER_DASH"></div>
        <div class="small" id="oneHeroMeta" data-i18n="UI_PLACEHOLDER_DASH"></div>

        <!-- 右侧解释预留区（可选） -->
        <div class="heroTopRow">
          <div class="heroMain"></div>
          <div class="heroSide" id="oneBlockers"></div>
        </div>
      </div>

      <!-- 下：上游实况条 -->
      <div class="card hero swHeroWide">
        <div class="k" data-i18n="T1_UPSTREAM_TITLE"></div>

        <!-- 保留原来的数据锚点 -->
        <div class="mono big2" id="swLine">
          <div class="swMain">
            <span><span class="swK" data-i18n="T1_SW_LABEL_V"></span> <span class="swV" data-i18n="UI_PLACEHOLDER_DASH"></span></span>
            <span class="swSep">｜</span>
            <span><span class="swK" data-i18n="T1_SW_LABEL_BT"></span> <span class="swV" data-i18n="UI_PLACEHOLDER_DASH"></span></span>
            <span class="swSep">｜</span>
            <span><span class="swK" data-i18n="T1_SW_LABEL_BZ"></span> <span class="swV" data-i18n="UI_PLACEHOLDER_DASH"></span></span>
            <span class="swSep">｜</span>
            <span><span class="swK" data-i18n="T1_SW_LABEL_N"></span> <span class="swV" data-i18n="UI_PLACEHOLDER_DASH"></span></span>
          </div>

          <div class="swAux">
            <span class="swAuxItem" data-i18n="T1_SW_CLOUD_LINE"></span>
            <span class="swAuxItem" data-i18n="T1_SW_MOON_LINE"></span>
          </div>
        </div>
        <div class="small" id="swMeta" data-i18n="UI_PLACEHOLDER_DASH"></div>
      </div>

      <!-- 中：C值柱状图 + 说明（与上方同宽） -->
      <div class="fullWidthStack">
        <div class="card chartCard">
          <div class="chartHead">
            <div>
              <div class="k" data-i18n="T1_CHART_TITLE"></div>
              <div class="small" data-i18n="T1_CHART_SUB"></div>
            </div>
            <div class="pill" id="unit10m" data-i18n="T1_UNIT_10M"></div>
          </div>
          <div class="chartWrap">
            <canvas id="cChart"></canvas>
          </div>
        </div>

        <div class="card explain">
          <div class="k" data-i18n="T1_LEVEL_TITLE"></div>
          <ul class="bullets">
            <li data-i18n="T1_LEVEL_C5"><b></b></li>
            <li data-i18n="T1_LEVEL_C4"><b></b></li>
            <li data-i18n="T1_LEVEL_C3"><b></b></li>
            <li data-i18n="T1_LEVEL_C2"><b></b></li>
            <li data-i18n="T1_LEVEL_C1"><b></b></li>
          </ul>
        </div>

        <div class="card explain hidden" id="oneExplainEN">
          <div class="k" data-i18n="T1_LEVEL_TITLE"></div>
          <ul class="bullets">
            <li data-i18n="T1_LEVEL_C5"><b></b></li>
            <li data-i18n="T1_LEVEL_C4"><b></b></li>
            <li data-i18n="T1_LEVEL_C3"><b></b></li>
            <li data-i18n="T1_LEVEL_C2"><b></b></li>
            <li data-i18n="T1_LEVEL_C1"><b></b></li>
          </ul>
        </div>
      </div>
      </div>
    </section>

    <!-- 3小时 -->
    <section id="t3" class="pane">


      <!-- 三个小时卡（结构对齐 72h dayCard） -->
      <div class="daysTri threeTri" id="threeTri">

        <div class="dayCard c1" id="threeSlot0">
          <div class="dayHead">
            <div class="dayLabel" id="threeSlot0Time" data-i18n="UI_PLACEHOLDER_DASH"></div>
          </div>
          <div class="dayConclusion" id="threeSlot0Conclusion" data-i18n="UI_PLACEHOLDER_DASH"></div>
          <div class="dayNote" id="threeSlot0Note" data-i18n="UI_PLACEHOLDER_DASH"></div>
          <div class="dayBasis" id="threeSlot0Reason" data-i18n="UI_PLACEHOLDER_DASH"></div>
        </div>

        <div class="dayCard c1" id="threeSlot1">
          <div class="dayHead">
            <div class="dayLabel" id="threeSlot1Time" data-i18n="UI_PLACEHOLDER_DASH"></div>
          </div>
          <div class="dayConclusion" id="threeSlot1Conclusion" data-i18n="UI_PLACEHOLDER_DASH"></div>
          <div class="dayNote" id="threeSlot1Note" data-i18n="UI_PLACEHOLDER_DASH"></div>
          <div class="dayBasis" id="threeSlot1Reason" data-i18n="UI_PLACEHOLDER_DASH"></div>
        </div>

        <div class="dayCard c1" id="threeSlot2">
          <div class="dayHead">
            <div class="dayLabel" id="threeSlot2Time" data-i18n="UI_PLACEHOLDER_DASH"></div>
          </div>
          <div class="dayConclusion" id="threeSlot2Conclusion" data-i18n="UI_PLACEHOLDER_DASH"></div>
          <div class="dayNote" id="threeSlot2Note" data-i18n="UI_PLACEHOLDER_DASH"></div>
          <div class="dayBasis" id="threeSlot2Reason" data-i18n="UI_PLACEHOLDER_DASH"></div>
        </div>

      </div>

      <!-- 观测窗口机会评估（下移到小时卡之后） -->
      <div class="card hero">
        <div class="burstModelHead" data-i18n="T3_STATE_TITLE"></div>
        <div class="burstState" id="threeState" data-i18n="UI_PLACEHOLDER_DASH"></div>
        <div class="burstHint" id="threeBurst" data-i18n="UI_PLACEHOLDER_DASH"></div>
        <div class="burstNote" data-i18n="T3_STATE_NOTE"></div>
      </div>

      <!-- 送达能力模型（下移为整行） -->
      <div class="card hero fullWidth">
        <div class="k" data-i18n="T3_DELIVER_TITLE"></div>
        <div class="big2" id="threeDeliver" data-i18n="UI_PLACEHOLDER_DASH"></div>
        <div class="small" id="threeDeliverMeta" data-i18n="UI_PLACEHOLDER_DASH"></div>
      </div>

      <!-- 分级说明保持不变 -->
      <div class="card explain">
        <div class="k" data-i18n="T3_LEVEL_TITLE"></div>
        <ul class="bullets">
          <li data-i18n="T3_LEVEL_C5"><b></b></li>
          <li data-i18n="T3_LEVEL_C4"><b></b></li>
          <li data-i18n="T3_LEVEL_C3"><b></b></li>
          <li data-i18n="T3_LEVEL_C2"><b></b></li>
          <li data-i18n="T3_LEVEL_C1"><b></b></li>
        </ul>
      </div>

      <div class="card explain hidden" id="threeExplainEN">
        <div class="k" data-i18n="T3_LEVEL_TITLE"></div>
        <ul class="bullets">
          <li data-i18n="T3_LEVEL_C5"><b></b></li>
          <li data-i18n="T3_LEVEL_C4"><b></b></li>
          <li data-i18n="T3_LEVEL_C3"><b></b></li>
          <li data-i18n="T3_LEVEL_C2"><b></b></li>
          <li data-i18n="T3_LEVEL_C1"><b></b></li>
        </ul>
      </div>

    </section>

    <!-- 72小时 -->
    <section id="t72" class="pane">
      <div class="card hero">
        <div class="k" data-i18n="T72_TITLE"></div>
        <div class="small heroSub" id="outlookSub" data-i18n="T72_SUBTITLE"></div>

        <!-- 72h 三列日卡：今天 / 明天 / 后天（由 app.js 动态填充） -->
        <div class="daysTri" id="daysTri">
          <div class="dayCard" id="day0">
            <div class="dayHead">
              <div class="dayLabel" data-i18n="T72_DAY_TODAY"></div>
              <div class="dayDate" id="day0Date" data-i18n="UI_PLACEHOLDER_DASH"></div>
            </div>
            <div class="dayConclusion" id="day0Conclusion" data-i18n="UI_PLACEHOLDER_DASH"></div>
            <div class="dayNote" id="day0Note" data-i18n="UI_PLACEHOLDER_DASH"></div>
            <div class="dayBasis" id="day0Basis" data-i18n="UI_PLACEHOLDER_DASH"></div>
          </div>

          <div class="dayCard" id="day1">
            <div class="dayHead">
              <div class="dayLabel" data-i18n="T72_DAY_TOMORROW"></div>
              <div class="dayDate" id="day1Date" data-i18n="UI_PLACEHOLDER_DASH"></div>
            </div>
            <div class="dayConclusion" id="day1Conclusion" data-i18n="UI_PLACEHOLDER_DASH"></div>
            <div class="dayNote" id="day1Note" data-i18n="UI_PLACEHOLDER_DASH"></div>
            <div class="dayBasis" id="day1Basis" data-i18n="UI_PLACEHOLDER_DASH"></div>
          </div>

          <div class="dayCard" id="day2">
            <div class="dayHead">
              <div class="dayLabel" data-i18n="T72_DAY_AFTER_TOMORROW"></div>
              <div class="dayDate" id="day2Date" data-i18n="UI_PLACEHOLDER_DASH"></div>
            </div>
            <div class="dayConclusion" id="day2Conclusion" data-i18n="UI_PLACEHOLDER_DASH"></div>
            <div class="dayNote" id="day2Note" data-i18n="UI_PLACEHOLDER_DASH"></div>
            <div class="dayBasis" id="day2Basis" data-i18n="UI_PLACEHOLDER_DASH"></div>
          </div>
        </div>
      </div>

      <div class="card explain">
        <div class="k" data-i18n="T72_LEVEL_TITLE"></div>
        <ul class="bullets">
          <li data-i18n="T72_LEVEL_C5"><b></b></li>
          <li data-i18n="T72_LEVEL_C4"><b></b></li>
          <li data-i18n="T72_LEVEL_C3"><b></b></li>
          <li data-i18n="T72_LEVEL_C2"><b></b></li>
          <li data-i18n="T72_LEVEL_C1"><b></b></li>
        </ul>
      </div>

      <div class="card explain hidden" id="outlookExplainEN">
        <div class="k" data-i18n="T72_LEVEL_TITLE"></div>
        <ul class="bullets">
          <li data-i18n="T72_LEVEL_C5"><b></b></li>
          <li data-i18n="T72_LEVEL_C4"><b></b></li>
          <li data-i18n="T72_LEVEL_C3"><b></b></li>
          <li data-i18n="T72_LEVEL_C2"><b></b></li>
          <li data-i18n="T72_LEVEL_C1"><b></b></li>
        </ul>
      </div>
    </section>

    <footer class="foot" id="footerBlock"></footer>
  </div>

  <!-- 背景介绍 Modal -->
  <div id="aboutModal" class="modal hidden" aria-hidden="true">
    <div class="modalMask" data-close="1"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="aboutTitle">
      <div class="modalHead">
        <div id="aboutTitle" class="modalTitle" data-i18n="ABOUT_MODAL_TITLE"></div>
        <button id="btnAboutClose" class="btn icon" type="button" aria-label="" data-i18n-attr="aria-label" data-i18n-attr-key="ABOUT_CLOSE_ARIA">✕</button>
      </div>
      <div class="modalBody">
        <div id="aboutBodyCN"></div>
        <div id="aboutBodyEN" class="hidden"></div>

      </div>
    </div>
  </div>

  <!-- NOAA 强提示弹窗（数据缺失时弹出，必须手动关闭） -->
  <div class="alertOverlay" id="alertOverlay" aria-hidden="true">
    <div class="alertCard" role="dialog" aria-modal="true" aria-labelledby="alertTitle">
      <div class="alertHead">
        <div class="alertTitle" id="alertTitle" data-i18n="ALERT_TITLE_DATA_CONF"></div>
        <button class="modalX" id="alertClose" aria-label="" data-i18n-attr="aria-label" data-i18n-attr-key="ALERT_CLOSE_ARIA">✕</button>
      </div>
      <div class="alertBody" id="alertBody" data-i18n="UI_PLACEHOLDER_DASH"></div>
      <div class="alertNote" id="alertNote" data-i18n="ALERT_NOTE_DATA_CONF"></div>
      <div class="alertFoot">
        <button class="btn primary" id="alertOk" type="button" data-i18n="ALERT_OK_BTN"></button>
      </div>
    </div>
  </div>
  
  <!-- Model config (optional): enable real AACGMv2 MLAT via your own endpoint; otherwise falls back to approx -->
  <script>
    window.MODEL_CONFIG = window.MODEL_CONFIG || {
      // 目前先使用“近似 AACGM 的简化磁纬”方案（不走外部换算服务）。
      // 如未来你自己搭好 AACGMv2 换算服务，再把下面 aacgmEndpoint 填成你的真实地址即可。
      // 约定：POST JSON {lat, lon, alt_km, time} -> 返回 JSON {mlat}
      aacgmEndpoint: ""
    };
  </script>
  <!-- your modules -->
  <script defer src="./adapter.js?v=0320"></script>
  <script defer src="./i18n.js?v=0320"></script>
  <script defer src="./ui.js?v=0320"></script>
  <script defer src="./model.js?v=0320"></script>
  <script defer src="./app.js?v=0320"></script>
  
</body>
</html>
